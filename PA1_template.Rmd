---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

The data set is already neatly formatted, the only processing we will do is convert the date column
into a proper `Date` object.

```{r echo=TRUE}
    if (!file.exists("activity.csv")) {
        unzip("activity.zip")
    }
    activity <- read.csv("activity.csv", colClasses = c("integer", "character", "integer"))
    activity$date <- as.Date(activity$date, "%Y-%m-%d")
```

## What is mean total number of steps taken per day?

#### Calculate the daily totals

Calculation of the daily sums is as simple as aggregating the steps by date.

```{r echo=TRUE}
    library(plyr)

    dailysteps <- aggregate(steps ~ date, data = activity, FUN = sum, na.action = na.omit)
    names(dailysteps) <- c("date", "total_steps")
```

#### Create a histogram plot of the totals

We'll use color to highlight concentration rather than overlay a density curve.

```{r echo=TRUE, fig.align='center'}
    library(ggplot2)

    ggplot(dailysteps, aes(x = total_steps)) + 
        geom_histogram(binwidth = 1000, aes(fill = ..count..), color = "black") + 
        scale_fill_gradient("count", low = "red", high = "steelblue") + 
        geom_rug() + 
        ggtitle("Total Steps by Day") + 
        xlab("Total Steps") + 
        ylab("Frequency")
```

#### Mean and median

```{r echo=TRUE}
    dailysteps.mean <- mean(dailysteps$total_steps)
    dailysteps.median <- median(dailysteps$total_steps)
```

- `r sprintf("**Mean:** %.0f", dailysteps.mean)`
- `r sprintf("**Median:** %.0f", dailysteps.median)`

## What is the average daily activity pattern?

First we need to know the average of each 5-minute period in the data set averaged across all days.

```{r echo=TRUE}
    ## for the moment at least continue ignoring NA values
    intervalsteps <- aggregate(steps ~ interval, data = activity, FUN = mean, na.action = na.omit)
    names(intervalsteps) <- c("interval", "mean_steps")
```

Plot the mean steps x interval to see the average daily activity pattern for the set. Add in some
market lines to show main points in the day.

```{r echo=TRUE, fig.align='center'}
    times <- data.frame(clocktime = factor(c("1", "2", "3", "4", "5", "6"), 
                                           labels = c("6AM", "9AM", "12PM", "3PM", "6PM", "9PM")),
                        interval = c(600, 900, 1200, 1500, 1800, 2100))

    ggplot(intervalsteps, aes(x = interval, y = mean_steps)) + 
        geom_line() +
        ggtitle("Daily Activity Pattern") +
        xlab("Interval") +
        ylab("Average Steps (all days)") +
        geom_vline(data = times, aes(xintercept = interval, color = clocktime), show_guide = TRUE)    
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
